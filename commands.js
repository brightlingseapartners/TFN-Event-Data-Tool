!function(){"use strict";var e,t={69367:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.reformatData=void 0,t.reformatData=function(){try{Excel.run((function(e){var t=e.workbook.worksheets.getActiveWorksheet(),o={"Donor Ref for S'Force":"Contact_1_TFN_ID_COPY__C","First Name/Org":"NPSP__CONTACT1_FIRSTNAME__C",Surname:"NPSP__CONTACT1_LASTNAME__C",D:"NPSP__DONATION_CAMPAIGN_NAME__C",E:"DONATION_PROJECT__C",F:"NPSP__DONATION_NAME__C","Paid? (Paid/Blank)":"NPSP__DONATION_STAGE__C","Payment Type for Salesforce":"Donation_Donation_Type__c",I:"Donation_Donation_Amount__c","Gift Aid":"Donation_Gift_Aid_Declaration__c",K:"NPSP__DONATION_AMOUNT__C","Payment Date":"NPSP__DONATION_DATE__C",M:"NPSP__DONATION_RECORD_TYPE_NAME__C","Company Name":"Organisation","Donation Donor":"Donation Donor"},a=t.getUsedRange().load("values");return e.sync().then((function(){var t=e.workbook.worksheets.getItemOrNullObject("Reformat");return t.load("isNullObject"),e.sync().then((function(){t.isNullObject?t=e.workbook.worksheets.add("Reformat"):t.getUsedRange().clear(),t.activate(),t.getRange("A1:O1").values=[Object.values(o)];var n=a.values,_=a.values[0][0],r=2;n.forEach((function(e,a){if(a>=10){var i=n[9],c=n[8],N=e[1],s=e[2],f=e[19],O=e[24];if("string"==typeof O&&"y"===O.trim().toLowerCase())return;var A=e[19];if(!isNaN(parseInt(A))){var D=parseInt(A),P=new Date(86400*(D-25569)*1e3);P.getDate(),P.getMonth(),P.getFullYear()}f=e[19];var u="";if(!isNaN(parseInt(f))){D=parseInt(f);var l=new Date(86400*(D-25569)*1e3);u=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(l)}console.log(u);for(var m=6;m<14;m++)if(e[m]){var T=[];for(var C in o){var v=i.indexOf(C);T[Object.values(o).indexOf(o[C])]="DONATION_PROJECT__C"===o[C]?c[m]:"NPSP__DONATION_CAMPAIGN_NAME__C"===o[C]?_:"NPSP__DONATION_NAME__C"===o[C]?N+" "+s+" - Donation to "+i[m]+" - "+u:"Donation_Donation_Amount__c"===o[C]||"NPSP__DONATION_AMOUNT__C"===o[C]?e[m]:"NPSP__DONATION_RECORD_TYPE_NAME__C"===o[C]?"Project Donation":"NPSP__DONATION_DATE__C"===o[C]?u:e[v]}t.getRange("A"+r+":O"+r).values=[T],r++}}})),t.getUsedRange().format.autofitColumns()}))})).catch((function(e){console.log(e)}))}))}catch(e){console.log(e)}}}},o={};e=function e(a){var n=o[a];if(void 0!==n)return n.exports;var _=o[a]={exports:{}};return t[a](_,_.exports,e),_.exports}(69367),Office.onReady((function(){})),Office.actions.associate("action",(function(e){var t={type:Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,message:"Performed action.",icon:"Icon.80x80",persistent:!0};Office.context.mailbox.item.notificationMessages.replaceAsync("ActionPerformanceNotification",t),e.completed()})),Office.actions.associate("dataReformat",(function(t){(0,e.reformatData)(),t.completed()}))}();
//# sourceMappingURL=commands.js.map